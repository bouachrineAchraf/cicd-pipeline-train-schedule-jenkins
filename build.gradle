plugins {
  id 'com.moowork.node' version '1.2.0'
}

node {
  version = '14.17.1' // Latest LTS version
  npmVersion = '7.15.1'
}

// Declare a build task
task build

// Declare a task to create a zip of the app
task zip(type: Zip) {
  from ('.') {
    include "*"
    include "bin/**"
    include "data/**"
    include "node_modules/**"
    include "public/**"
    include "routes/**"
    include "views/**"
  }
  destinationDir = file("dist")
  baseName = "trainSchedule"
}

// Declare task dependencies
build.dependsOn(zip)
zip.dependsOn(npm_run_build)
npm_run_build.dependsOn(npm_test)
npm_test.dependsOn(npm_install)
npm_run_build.dependsOn(npm_install)
